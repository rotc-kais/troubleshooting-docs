---
kind:
  - Troubleshooting
products:
  - Alauda Container Platform
  - Alauda DevOps
  - Alauda AI
  - Alauda Application Services
  - Alauda Service Mesh
  - Alauda Developer Portal
ProductsVersion:
  - 4.1.0,4.2.x
---
<!-- A type of document that involves encountering a fault, diagnosing it, performing root cause analysis, and providing solutions. -->

# 压测问题故障排除文章

CPU使用率持续超过90% 内存占用超过80%并触发OOM Killer 网络延迟增加200ms以上

## Cause
- 未设置Pod资源限制
- JVM堆内存配置为-XX:MaxRAMPercentage=80.0
- 节点网络带宽仅1Gbps
- 使用gp2类型EBS卷
- Tomcat线程池maxThreads=200

## Resolution
- 添加Kubernetes资源限制: resources.limits.cpu: '2', memory: 4Gi
- 调整JVM参数为-Xmx3g -Xms3g
- 升级节点到25Gbps网络
- 更换为gp3类型EBS并设置IOPS=6000
- 配置线程池maxThreads=500

## [workaround]
- 临时降低压测并发数至50%
- 将流量调度到低负载可用区

## [Related Information]
- Environment: Kubernetes 1.22, AWS EKS集群, Java 11应用, Tomcat 9容器, 节点类型c5.4xlarge
- 8080端口
- /metrics端点
- Prometheus
- Grafana
- JVM堆配置
- Kubernetes资源限制
- threadPoolExecutor参数
- Component: (待归类)
- Page ID: 232490943
- Original Title: 压测问题故障排除文章
