---
kind:
  - Troubleshooting
products:
  - Alauda Container Platform
  - Alauda DevOps
  - Alauda AI
  - Alauda Application Services
  - Alauda Service Mesh
  - Alauda Developer Portal
ProductsVersion:
  - 4.1.0,4.2.x
---
<!-- A type of document that involves encountering a fault, diagnosing it, performing root cause analysis, and providing solutions. -->

# 故障排除

Pod状态持续CrashLoopBackOff 健康检查频繁失败 服务间调用出现Connection refused

## Cause
- 探针(probe)配置超时时间过短
- NetworkPolicy规则阻止了必要端口通信
- 配置中心未开启热加载功能
- JVM内存参数Xmx设置过高
- 节点可用内存低于20%

## Resolution
- kubectl describe pod [pod-name] 查看LastState信息
- 检查 /etc/app/config.yaml 中的 readinessProbe.timeoutSeconds 值
- 在Calico配置中开放8080/tcp和8443/tcp端口策略
- 在Consul配置中添加 auto-reload = true 参数
- 调整Deployment的resources.limits.memory为容器总内存的80%

## [workaround]
- kubectl scale deploy [deploy-name] --replicas=0 && sleep 60 && --replicas=3
- 临时执行 echo 3 > /proc/sys/vm/drop_caches

## [Related Information]
- Environment: Kubernetes 1.20+环境，节点内存配置低于8GB
- kubelet
- Calico NetworkPolicy
- Consul配置中心
- JVM Xmx参数
- kube-state-metrics
- Component: (待归类)
- Page ID: 219088299
- Original Title: 故障排除-devops产品组件
