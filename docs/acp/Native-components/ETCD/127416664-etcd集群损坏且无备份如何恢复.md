---
kind:
  - Troubleshooting
products:
  - Alauda Container Platform
  - Alauda DevOps
  - Alauda AI
  - Alauda Application Services
  - Alauda Service Mesh
  - Alauda Developer Portal
ProductsVersion:
  - 4.1.0,4.2.x
---
<!-- A type of document that involves encountering a fault, diagnosing it, performing root cause analysis, and providing solutions. -->

# etcd集群损坏且无备份如何恢复

etcd集群损坏 无备份 接受部分数据丢失（wal未落盘的数据）

## Cause

## Resolution
- mkdir /tmp/etcd-bak
- mv /var/lib/etcd/member /tmp/etcd-bak
- cd /tmp/etcd-bak/member/snap
- etcdctl --endpoints=$ENDPOINTS --cacert=$CACERT --cert=$CERT --key=$KEY snapshot restore db --initial-cluster=acp38-rm1=https://192.168.15.135:2380 --initial-advertise-peer-urls=https://192.168.15.135:2380 --name=acp38-rm1 --skip-hash-check=true --date-dir=/var/lib/etcd

## [workaround]

## [Related Information]
- Environment: 通用
- /var/lib/etcd
- /etc/kubernetes/manifests/etcd.yaml
- --initial-cluster
- --initial-advertise-peer-urls
- --name
- --skip-hash-check
- --date-dir
- 2380
- $CACERT
- $CERT
- $KEY
- Component: ETCD
- Page ID: 127416664
- Original Title: etcd集群损坏且无备份如何恢复
