---
kind:
  - Troubleshooting
products:
  - Alauda Container Platform
  - Alauda DevOps
  - Alauda AI
  - Alauda Application Services
  - Alauda Service Mesh
  - Alauda Developer Portal
ProductsVersion:
  - 4.1.0,4.2.x
---
<!-- A type of document that involves encountering a fault, diagnosing it, performing root cause analysis, and providing solutions. -->

# ES分片分配失败解决方案

GET /_cluster/allocation/explain GET _cat/indices?v&health=red GET /_cat/shards?v&h=n,index,shard,prirep,state,sto,sc,unassigned.reason,unassigned.details

## Cause
- ALLOCATION_FAILED
- CLUSTER_RECOVERED
- DANGLING_INDEX_IMPORTED
- EXISTING_INDEX_RESTORED
- INDEX_CREATED
- INDEX_REOPENED
- NEW_INDEX_RESTORED
- NODE_LEFT
- REALLOCATED_REPLICA
- REINITIALIZED
- REPLICA_ADDED
- REROUTE_CANCELLED

## Resolution
- POST /_cluster/reroute?retry_failed=true
- PUT /indexname/_settings
{
  "index": {
    "allocation": {
      "max_retries": 20
    }
  }
}
- POST /index/_close(_open)

## [workaround]

## [Related Information]
- Environment: 通用
- index.allocation.max_retries
- /_cluster/reroute
- /_settings
- /_close
- /_open
- Component: Node
- Page ID: 120098743
- Original Title: ES分片分配失败解决方案
