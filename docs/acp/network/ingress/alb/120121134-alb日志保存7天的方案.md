---
kind:
  - Troubleshooting
products:
  - Alauda Container Platform
  - Alauda DevOps
  - Alauda AI
  - Alauda Application Services
  - Alauda Service Mesh
  - Alauda Developer Portal
ProductsVersion:
  - 4.1.0,4.2.x
---
<!-- A type of document that involves encountering a fault, diagnosing it, performing root cause analysis, and providing solutions. -->

# alb日志保存7天的方案

日志未按预期保留7天 日志切割时间不符合预期 压缩文件未带日期

## Cause
- rotate参数未设置为7
- dateext参数未配置
- compress参数未生效
- 宿主机目录挂载配置错误
- logrotate配置未正确加载

## Resolution
- 修改alauda文件中rotate参数值为7
- 确保配置块包含dateext参数
- 检查compress参数是否存在
- 验证volumes挂载路径配置：
- hostPath:
  path: /var/log/nginx
- hostPath:
  path: /logrotate
- 执行kubectl rollout restart deploy global-alb2 -ncpaas-system

## [workaround]

## [Related Information]
- Environment: ACP 3.4 (3.x版本)
- /var/log/nginx
- /logrotate
- rotate
- dateext
- compress
- logrotate.d配置
- global-alb2部署
- Component: alb
- Page ID: 120121134
- Original Title: alb日志保存7天的方案
