---
kind:
  - Troubleshooting
products:
  - Alauda Container Platform
  - Alauda DevOps
  - Alauda AI
  - Alauda Application Services
  - Alauda Service Mesh
  - Alauda Developer Portal
ProductsVersion:
  - 4.1.0,4.2.x
---
<!-- A type of document that involves encountering a fault, diagnosing it, performing root cause analysis, and providing solutions. -->

# 通过nodeport暴露的业务与业务链接部分节点存在链接重置问题

通过nodeport暴露的业务链接存在间歇性reset 在问题节点上访问跨节点pod时curl无响应并超时 抓包发现rst返回

## Cause
- 问题节点存在异常sysctl参数配置：net.netfilter.nf_conntrack_tcp_timeout_established=180（3分钟）
- 正常节点该参数值为432000（24小时）
- 异常参数由平台alb组件通过run.sh脚本设置

## Resolution
- 临时生效：sysctl -w net.netfilter.nf_conntrack_tcp_timeout_established=432000
- 永久生效：编辑/etc/sysctl.conf添加net.netfilter.nf_conntrack_tcp_timeout_established=432000后执行sysctl -p
- 避免需要长超时的网关服务与alb组件同节点部署

## [workaround]

## [Related Information]
- Environment: tlinux操作系统 + calico网络
- nodeport
- calico
- alb组件
- run.sh
- net.netfilter.nf_conntrack_tcp_timeout_established
- Component: Calico
- Page ID: 115535519
- Original Title: 网络-通过nodeport暴露的业务与业务链接部分节点存在链接重置问题
