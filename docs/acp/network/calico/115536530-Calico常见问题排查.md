---
kind:
  - Troubleshooting
products:
  - Alauda Container Platform
  - Alauda DevOps
  - Alauda AI
  - Alauda Application Services
  - Alauda Service Mesh
  - Alauda Developer Portal
ProductsVersion:
  - 4.1.0,4.2.x
---
<!-- A type of document that involves encountering a fault, diagnosing it, performing root cause analysis, and providing solutions. -->

# 【Calico】常见问题排查

Pod 网络不通（跨节点/跨主机通信失败） calico-node 组件状态异常（CrashLoopBackOff/NotReady） IP 地址分配失败（No available IP addresses）

## Cause
- 网络插件配置错误（CIDR 冲突/MTU 不匹配）
- 节点防火墙阻止 179（BGP）/4789（VxLAN）/5473（Typha）等端口
- IPPool 资源耗尽或配置范围过小
- 网络策略 selector 配置错误
- BGP 对等体 AS 号配置错误

## Resolution
- 检查 calico 配置：calicoctl get nodes -o wide
- 放行防火墙端口：ufw allow 179/tcp && ufw reload
- 扩容 IPPool：calicoctl patch ippool default-ipv4-ippool -p '{"spec":{"cidr":"10.244.0.0/16"}}'
- 验证网络策略：calicoctl get networkpolicy -o yaml
- 检查 BGP 配置：calicoctl node status

## [workaround]
- 重启 calico-node：kubectl delete pod -n kube-system -l k8s-app=calico-node

## [Related Information]
- Environment: Calico v3.20+ / Kubernetes 1.21+ / IPIP 模式
- calico-node DaemonSet
- calicoctl CLI
- IPPool CRD
- BGPPeer CRD
- Felix 配置
- Component: Calico
- Page ID: 115536530
- Original Title: 【Calico】常见问题排查
