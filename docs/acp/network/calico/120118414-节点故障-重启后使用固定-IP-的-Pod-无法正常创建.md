---
kind:
  - Troubleshooting
products:
  - Alauda Container Platform
  - Alauda DevOps
  - Alauda AI
  - Alauda Application Services
  - Alauda Service Mesh
  - Alauda Developer Portal
ProductsVersion:
  - 4.1.0,4.2.x
---
<!-- A type of document that involves encountering a fault, diagnosing it, performing root cause analysis, and providing solutions. -->

# 节点故障/重启后，使用固定 IP 的 Pod 无法正常创建

新调度的 Pod 创建后无法启动，报错：error getting IP from IPAM: resource already exists: xxx.xxx.xxx.xxx calicoctl ipam show --ip=<IP> 显示 IP not assigned 但无法通过 calicoctl ipam release 释放

## Cause
- Calico v3.16.1 存在 IPAM 资源泄漏问题，节点异常后 IPAM 未正确释放资源

## Resolution
- 手动修改故障 IP 对应的 ipamblock CR：1. 定位 IP 所在 ipamblock 2. 修改 allocations/attributes/unallocated 字段 3. 执行 kubectl apply --validate=false --server-side=true --force-conflicts=true -f <YAML>

## [workaround]

## [Related Information]
**Screenshots**
![](assets/jie-dian-gu-zhang-zhong-qi-hou-shi-yong-gu-ding-ip-de-pod-wu-fa-zheng-chang-chua/image2022-8-3_16-9-6.png)
![](assets/jie-dian-gu-zhang-zhong-qi-hou-shi-yong-gu-ding-ip-de-pod-wu-fa-zheng-chang-chua/image2022-8-3_16-5-10.png)
![](assets/jie-dian-gu-zhang-zhong-qi-hou-shi-yong-gu-ding-ip-de-pod-wu-fa-zheng-chang-chua/image2022-8-3_15-45-6.png)
[![](assets/jie-dian-gu-zhang-zhong-qi-hou-shi-yong-gu-ding-ip-de-pod-wu-fa-zheng-chang-chua/placeholder-medium-file_1.png)](/download/attachments/120118414/calico-release-ip.sh?version=1&modificationDate=1660873888000&api=v2)
- Environment: Kubernetes v1.21.4, Calico v3.16.1, ACP v3.6
- ipamblock CRD
- calicoctl
- cni.projectcalico.org/ipAddrs
- kube-system/calico-node
- Component: Calico
- Page ID: 120118414
- Original Title: 节点故障/重启后，使用固定 IP 的 Pod 无法正常创建
