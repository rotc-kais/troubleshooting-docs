---
kind:
  - Troubleshooting
products:
  - Alauda Container Platform
  - Alauda DevOps
  - Alauda AI
  - Alauda Application Services
  - Alauda Service Mesh
  - Alauda Developer Portal
ProductsVersion:
  - 4.1.0,4.2.x
---
<!-- A type of document that involves encountering a fault, diagnosing it, performing root cause analysis, and providing solutions. -->

# 单栈集群偶现 Pod 无法解析外部 DNS 域名

Pod 无法解析外部 DNS 域名 偶现域名解析为 IPv4 地址 coredns 日志报错 192.168.16.19:53 network unreachable

## Cause
- CoreDNS 健康检查使用默认域名 '.' 被交换机 DNS 代理视为非法
- IPv6 单栈环境无法访问 IPv4 上游 DNS Server
- 健康检查失败导致随机选择上游 Server 造成解析不稳定

## Resolution
- 修改 CoreDNS forward 插件配置的 health_check 域名
- 设置 forward 插件参数 max_fails=0 禁用健康检查

## [workaround]

## [Related Information]
- Environment: IPv6 单栈 Kubernetes 集群
- coredns forward 插件
- /etc/resolv.conf nameserver 配置
- health_check 参数
- max_fails 参数
- 交换机 DNS 代理配置
- Component: CoreDNS
- Page ID: 149606553
- Original Title: 单栈集群偶现 Pod 无法解析外部 DNS 域名
