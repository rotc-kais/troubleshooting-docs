---
kind:
  - Troubleshooting
products:
  - Alauda Container Platform
  - Alauda DevOps
  - Alauda AI
  - Alauda Application Services
  - Alauda Service Mesh
  - Alauda Developer Portal
ProductsVersion:
  - 4.1.0,4.2.x
---
<!-- A type of document that involves encountering a fault, diagnosing it, performing root cause analysis, and providing solutions. -->

# ovs

ovs-vswitchd 日志出现 'blocked ... ms waiting for main to quiesce' 警告 ovs-vswitchd 日志报告 'Unreasonably long ... poll interval' 告警 ovs-vswitchd 日志出现 'could not open network device ... (No such device)' 错误

## Cause
- ovs 代码中获取 IP 地址逻辑在主机存在大量 IP 时存在性能瓶颈
- kube-ipvs0 接口携带大量 IP 导致处理延迟

## Resolution
- 应用代码优化补丁: https://github.com/kubeovn/kube-ovn/pull/3650

## [workaround]
- 调整 ovs-ovn 的 CPU limit 从 1000m 提高到 2c

## [Related Information]
**Screenshots**
![image](https://private-user-images.githubusercontent.com/13048299/298079220-19aa3506-6efc-4b71-8155-451e8a4cda55.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MDU5MTQwNjcsIm5iZiI6MTcwNTkxMzc2NywicGF0aCI6Ii8xMzA0ODI5OS8yOTgwNzkyMjAtMTlhYTM1MDYtNmVmYy00YjcxLTgxNTUtNDUxZThhNGNkYTU1LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNDAxMjIlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQwMTIyVDA4NTYwN1omWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTc5NjA5MjZjZjJlOTc5ZWVlZjAyY2U4YThiOTk3N2U3YmMxM2ZhNjA1MjU5NzJkNmViZjE2NDJiMGFlYTE3NmUmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0JmFjdG9yX2lkPTAma2V5X2lkPTAmcmVwb19pZD0wIn0.NuFvz4OKiiBAROYROA9amkEPOipplMx6_QnLuj6qY-Q)
![image](https://private-user-images.githubusercontent.com/13048299/298079438-3e9757ce-27c2-4bb9-b74f-e9803554a664.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MDU5MTQwNjcsIm5iZiI6MTcwNTkxMzc2NywicGF0aCI6Ii8xMzA0ODI5OS8yOTgwNzk0MzgtM2U5NzU3Y2UtMjdjMi00YmI5LWI3NGYtZTk4MDM1NTRhNjY0LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNDAxMjIlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQwMTIyVDA4NTYwN1omWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTgwZTQ4ZTkzMmE4N2QwZmZlNTExZDg4OWViNzhlZDU1ODUyZDk0ZDM1YzFlMDQwZTQyNzBiMjYxZTk2MzRjODImWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0JmFjdG9yX2lkPTAma2V5X2lkPTAmcmVwb19pZD0wIn0.m10YnXpE88WTkXSp6UHQ8XvDp2MpypZGl6ezTenc9Pk)
![image](https://private-user-images.githubusercontent.com/13048299/298267517-0fcfbc1c-b76d-4832-ac79-3c6ac7411816.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MDU5MTQwNjcsIm5iZiI6MTcwNTkxMzc2NywicGF0aCI6Ii8xMzA0ODI5OS8yOTgyNjc1MTctMGZjZmJjMWMtYjc2ZC00ODMyLWFjNzktM2M2YWM3NDExODE2LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNDAxMjIlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQwMTIyVDA4NTYwN1omWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTIzYjZiOGJiNjc3MDEwODRmZTVkMzk3NjhjZWQ3ZmI3ZDQxMDhjZDhkZjQ3NGE4ZjBjNjdjYmE2Y2M3ZmIwNTEmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0JmFjdG9yX2lkPTAma2V5X2lkPTAmcmVwb19pZD0wIn0.4Z2yUf4aE4VA7TKJ2x7xkXX1SHEQ859r9i2et9juLEA)
- Environment: 大规模 Kubernetes 集群
- ovs-vswitchd
- ovn-controller
- br-int
- unix:/var/run/openvswitch/br-int.mgmt
- kube-ipvs0
- Component: kube-ovn
- Page ID: 178225455
- Original Title: ovs-vswitchd/ovn-controller CPU 占用过高
