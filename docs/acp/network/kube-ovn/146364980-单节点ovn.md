---
kind:
  - Troubleshooting
products:
  - Alauda Container Platform
  - Alauda DevOps
  - Alauda AI
  - Alauda Application Services
  - Alauda Service Mesh
  - Alauda Developer Portal
ProductsVersion:
  - 4.1.0,4.2.x
---
<!-- A type of document that involves encountering a fault, diagnosing it, performing root cause analysis, and providing solutions. -->

# 单节点ovn

单节点ovn-central无法启动 日志提示-detected database corruption for file /etc/ovn/ovnsb_db.db, rebuild it

## Cause
- 主机重启后ovnsb_db.db库文件损坏

## Resolution
- kubectl scale deployment -n kube-system --replicas=0 ovn-central
- mv /etc/origin/ovn/ovnsb_db.db /tmp
- kubectl scale deployment -n kube-system --replicas=1 ovn-central
- for ns in $(kubectl get ns --no-headers -o custom-columns=NAME:.metadata.name); do for pod in $(kubectl get pod --no-headers -n "$ns" --field-selector spec.restartPolicy=Always -o custom-columns=NAME:.metadata.name,HOST:spec.hostNetwork | awk '{if ($2!="true") print $1}'); do kubectl delete pod "$pod" -n "$ns"; done; done

## [workaround]

## [Related Information]
- Environment: 通用
- ovn-central
- ovnsb_db.db
- /etc/origin/ovn/ovnsb_db.db
- kube-system
- --field-selector spec.restartPolicy=Always
- Component: kube-Ovn
- Page ID: 146364980
- Original Title: 单节点ovn-central无法启动日志提示-detected database corruption for file /etc/ovn/ovnsb_db.db, rebuild it
