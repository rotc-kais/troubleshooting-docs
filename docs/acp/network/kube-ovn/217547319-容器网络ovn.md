---
kind:
  - Troubleshooting
products:
  - Alauda Container Platform
  - Alauda DevOps
  - Alauda AI
  - Alauda Application Services
  - Alauda Service Mesh
  - Alauda Developer Portal
ProductsVersion:
  - 4.1.0,4.2.x
---
<!-- A type of document that involves encountering a fault, diagnosing it, performing root cause analysis, and providing solutions. -->

# 容器网络（ovn）

无法分配ip 已分配ip提示到网关不通 ovn-central启动异常

## Cause
- kube-ovn-cni/kube-proxy异常
- SB/DB数据库不同步
- ovn-central数据库损坏
- 网卡checksumming配置开启
- networkpolicy限制
- 底层网络策略限制
- coredns配置错误
- 内核参数配置不当

## Resolution
- 检查kube-ovn-cni/kube-proxy组件状态
- 执行ovs-dpctl del-flows清理脏数据
- 修复ovn-central数据库文件
- ethtool -K ETH tx off关闭网卡checksum
- 清理冲突networkpolicy资源
- 检查交换机trunk配置
- 修改coredns configmap配置
- 调整sysctl内核参数

## [workaround]
- nsenter -a -t `pidof -s ovn-controller` ovs-vsctl find inter external-ids:ip=xx.xx.xx.xx
- conntrack -D删除错误链路追踪
- 临时关闭ovn-cni健康检查
- echo 1 > /var/log/kube-ovn/kube-ovn-pinger.log清空日志

## [Related Information]
**Screenshots**
![](assets/rong-qi-wang-luo-ovn/image-2024-11-21_15-30-17.png)
- Environment: ovn版本、操作系统版本、平台版本、underlay/overlay网络模式、网卡MTU值、checksum配置状态
- 6641/6642端口
- /var/log/kube-ovn
- kube-ovn-controller
- ovn-nbctl lb-list
- geneve-sys_6081
- ovn0网卡
- networkpolicy资源
- rmem_default内核参数
- Component: kube-Ovn
- Page ID: 217547319
- Original Title: 容器网络（ovn）
