---
kind:
  - Troubleshooting
products:
  - Alauda Container Platform
  - Alauda DevOps
  - Alauda AI
  - Alauda Application Services
  - Alauda Service Mesh
  - Alauda Developer Portal
ProductsVersion:
  - 4.1.0,4.2.x
---
<!-- A type of document that involves encountering a fault, diagnosing it, performing root cause analysis, and providing solutions. -->

# ovn集群，ovn

kube-ovn-cni pod无法启动，dmesg -T显示OOM日志 ovs-appctl bridge/dump-flows br-int显示大量priority=31000的openflow表项 当ovn.default.u2o_exclude_ip.ip4地址数量超过7时稳定复现OOM

## Cause
- u2o功能开启导致生成大量31000优先级的openflow表项
- ovn-controller在解析u2o_exclude_ip规则时会将underlay subnet切分为大量细粒度流表
- address set地址数量增加导致流表数量指数级增长

## Resolution
- 关闭u2o功能
- 应用补丁https://github.com/kubeovn/kube-ovn/pull/3099

## [workaround]
- 调整ovn.default.u2o_exclude_ip.ip4地址数量不超过7

## [Related Information]
**Screenshots**
![](assets/ovnji-qun-ovn-controller-oom/152131_image-2023-07-27-18-56-11-223_1.png)
![](assets/ovnji-qun-ovn-controller-oom/image2023-7-31_11-33-2.png)
![image](https://user-images.githubusercontent.com/47097611/257427935-35560cb3-bf8b-4d0d-b2e5-fa6358ba8bae.png)
![](https://user-images.githubusercontent.com/47097611/257429165-857be024-21f6-4dbc-a723-8a9842e523a5.png)
![](assets/ovnji-qun-ovn-controller-oom/image2023-8-1_17-28-57.png)
![](assets/ovnji-qun-ovn-controller-oom/image2023-8-1_17-30-57.png)
[![](assets/ovnji-qun-ovn-controller-oom/placeholder-medium-zip_1.png)](/download/attachments/155322051/u2o%20openflow%E6%B5%81%E8%A1%A8%E8%BF%87%E5%A4%9A.zip?version=1&modificationDate=1690774552000&api=v2)
- Environment: CNI版本：Kube-OVN v1.9.27
- u2o功能
- ovn-controller
- openflow表项
- priority=31000
- ovn.default.u2o_exclude_ip.ip4
- br-int网桥
- Component: kube-Ovn
- Page ID: 155322051
- Original Title: ovn集群，ovn-controller oom
