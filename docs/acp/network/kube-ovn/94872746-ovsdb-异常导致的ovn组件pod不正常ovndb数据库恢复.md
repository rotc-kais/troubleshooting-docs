---kind:   - Troubleshootingproducts:    - Alauda Container Platform   - Alauda DevOps   - Alauda AI   - Alauda Application Services   - Alauda Service Mesh   - Alauda Developer PortalProductsVersion:   - 4.1.0,4.2.x---<!-- A type of document that involves encountering a fault, diag...it, performing root cause analysis, and providing solutions. --># ovsdb 异常导致的ovn组件pod不正常(ovndb数据库恢复)ovs组件总是无法正常工作，长期保持重启或0/1 not ready状态 northd ha集群始终不稳定 底层不稳定导致上层网络不稳定及不可用## Cause- 磁盘被用户用完等情况导致网络状态未及时同步到ovsdb(nb, sb)- 重启pod时数据库无法正常同步和启动## Resolution- 确定一个用于恢复数据的基准node，将所有ovn组件的replica number置0- 在基准node上运行docker run -it -v /etc/origin/openvswitch:/etc/openvswitch kubeovn/kube-ovn:v1.3.0 bash- 根据ovn版本进入指定目录：ovn1.3版本cd /etc/openvswitch；ovn1.7+版本cd /etc/origin/ovn- 执行ovsdb-tool cluster-to-standalone ovnnb_db_standalone.db ovnnb_db.db- 执行ovsdb-tool cluster-to-standalone ovnsb_db_standalone.db ovnsb_db.db- 将恢复后的ovndb(nb/sb)复制到每个node上- 恢复ovn组件replica- 执行网络重置(可选)## [workaround]- 选择网络重置(如果不需要恢复网络状态)## [Related Information]- Environment: Kubernetes with Kube-OVN v1.3.0- ovsdb- ovnnb_db- ovnsb_db- ovn-northd- /etc/origin/openvswitch- /etc/origin/ovn- ovsdb-tool- kubeovn/kube-ovn:v1.3.0- Component: kube-Ovn- Page ID: 94872746- Original Title: ovsdb 异常导致的ovn组件pod不正常(ovndb数据库恢复)