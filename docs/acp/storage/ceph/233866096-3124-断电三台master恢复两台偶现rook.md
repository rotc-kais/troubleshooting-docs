---
kind:
  - Troubleshooting
products:
  - Alauda Container Platform
  - Alauda DevOps
  - Alauda AI
  - Alauda Application Services
  - Alauda Service Mesh
  - Alauda Developer Portal
ProductsVersion:
  - 4.1.0,4.2.x
---
<!-- A type of document that involves encountering a fault, diagnosing it, performing root cause analysis, and providing solutions. -->

# 3.12.4 断电三台master恢复两台，【偶现】rook

rook-ceph的pod crash 无法正常使用

## Cause
- rook-ceph-operator处理mon failover时发生重启或cephcluster资源更新触发reconcile
- operator重新加载配置后认为需要启动4个mon导致ceph组件pod重启触发断言

## Resolution
- 关闭mon failover：修改cephcluster/ceph-cluster资源，设置spec.healthCheck.daemonHealth.mon.timeout为"0"
- 节点不可恢复时开启failover创建新mon后关闭

## [workaround]
- 停止operator pod
- 编辑rook-ceph-mon-endpoints configmap删除failover的mon信息
- 删除对应mon的deployment
- 删除故障节点/var/lib/rook/下对应mon目录
- 重启operator pod

## [Related Information]
- Environment: 3.12.4
- 6789
- /var/lib/rook/
- rook-ceph-operator
- rook-ceph-mon-endpoints
- cephcluster
- spec.healthCheck.daemonHealth.mon.disabled
- spec.healthCheck.daemonHealth.mon.timeout
- Component: Ceph
- Page ID: 233866096
- Original Title: 3.12.4 断电三台master恢复两台，【偶现】rook-ceph的pod crash 无法正常使用
