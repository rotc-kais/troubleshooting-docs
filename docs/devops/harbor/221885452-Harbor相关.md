---
kind:
  - Troubleshooting
products:
  - Alauda Container Platform
  - Alauda DevOps
  - Alauda AI
  - Alauda Application Services
  - Alauda Service Mesh
  - Alauda Developer Portal
ProductsVersion:
  - 4.1.0,4.2.x
---
<!-- A type of document that involves encountering a fault, diagnosing it, performing root cause analysis, and providing solutions. -->

# Harbor相关

用户无法通过docker login登录Harbor，提示 'x509: certificate signed by unknown authority' Harbor核心组件core服务日志出现 'failed to connect to redis: context deadline exceeded' 镜像上传失败，提示 '413 Request Entity Too Large'

## Cause
- Docker客户端未信任Harbor的自签名证书
- Redis服务不可达或harbor.yml中redis参数配置错误
- Nginx反向代理未配置client_max_body_size

## Resolution
- 将Harbor的CA证书复制到Docker客户端目录：mkdir -p /etc/docker/certs.d/harbor.domain.com && cp harbor.crt /etc/docker/certs.d/harbor.domain.com/ && systemctl restart docker
- 检查redis服务状态：docker-compose ps | grep redis，检查harbor.yml中redis配置项
- 在nginx.conf的http模块添加 client_max_body_size 0; 并执行nginx -s reload

## [workaround]
- docker login时添加 --insecure-registry 参数（仅限测试环境）
- 上传镜像时添加 --max-body-size 参数：docker push --max-body-size 0 harbor.domain.com/project/image:tag

## [Related Information]
- Environment: Harbor v2.5.0
- Docker
- Redis
- Nginx
- harbor.yml
- client_max_body_size
- 6379
- 443
- Component: harbor
- Page ID: 221885452
- Original Title: Harbor相关
