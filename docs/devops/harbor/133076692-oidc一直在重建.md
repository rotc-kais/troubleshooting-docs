---
kind:
  - Troubleshooting
products:
  - Alauda Container Platform
  - Alauda DevOps
  - Alauda AI
  - Alauda Application Services
  - Alauda Service Mesh
  - Alauda Developer Portal
ProductsVersion:
  - 4.1.0,4.2.x
---
<!-- A type of document that involves encountering a fault, diagnosing it, performing root cause analysis, and providing solutions. -->

# oidc一直在重建

harbor-oidc pod 持续重建 Harbor OIDC Job 完成后被删除

## Cause
- k8s 1.23+ 默认启用 ttl-after-finished-controller 自动清理已完成 Job

## Resolution
- 调整 Harbor OIDC Job 参数：添加 skip-sync 注解并移除 ttlSecondsAfterFinished 属性
- 后续版本已修复该问题

## [workaround]
- 编辑 job 添加 annotations: skip-sync: "true"
- 删除 job 的 ttlSecondsAfterFinished: 100 配置

## [Related Information]
**Screenshots**
![image-2022-11-07-15-48-01-811.png](https://jira.alauda.cn/secure/attachment/127450/image-2022-11-07-15-48-01-811.png)
- Environment: 3.8.0--3.10.1
- harbor-oidc job
- ttl-after-finished-controller
- kube-controller-manager
- ttlSecondsAfterFinished
- skip-sync
- Component: harbor
- Page ID: 133076692
- Original Title: harbor-oidc一直在重建
