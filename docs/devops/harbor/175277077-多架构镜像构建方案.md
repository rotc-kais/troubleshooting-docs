---
kind:
  - Troubleshooting
products:
  - Alauda Container Platform
  - Alauda DevOps
  - Alauda AI
  - Alauda Application Services
  - Alauda Service Mesh
  - Alauda Developer Portal
ProductsVersion:
  - 4.1.0,4.2.x
---
<!-- A type of document that involves encountering a fault, diagnosing it, performing root cause analysis, and providing solutions. -->

# 多架构镜像构建方案

构建多架构镜像失败 默认构建器不支持多架构 镜像未正确推送至仓库

## Cause
- 未安装buildx插件或版本过低
- 未创建支持多架构的buildx构建器
- containerd环境未正确配置buildkit
- 镜像仓库认证配置错误

## Resolution
- docker buildx create --name=<builder-name> --driver=docker-container
- buildctl build --frontend dockerfile.v0 --opt platform=linux/amd64,linux/arm64 --local context=. --local dockerfile=. --output type=image,name=<image>,push=true
- 配置~/.docker/config.json进行镜像仓库认证
- docker manifest create <merged-image> <arch-image1> <arch-image2> && docker manifest push <merged-image>

## [workaround]

## [Related Information]
**Screenshots**
![](assets/duo-jia-gou-jing-xiang-gou-jian-fang-an/image-2023-12-5_12-5-20.png)
![](assets/duo-jia-gou-jing-xiang-gou-jian-fang-an/image-2023-12-5_12-6-6.png)
![](assets/duo-jia-gou-jing-xiang-gou-jian-fang-an/image-2023-12-5_12-6-30.png)
![](assets/duo-jia-gou-jing-xiang-gou-jian-fang-an/image-2023-12-5_14-46-48.png)
![](assets/duo-jia-gou-jing-xiang-gou-jian-fang-an/image-2023-12-5_14-47-11.png)
![](assets/duo-jia-gou-jing-xiang-gou-jian-fang-an/image-2023-12-5_14-47-29.png)
![](assets/duo-jia-gou-jing-xiang-gou-jian-fang-an/image-2023-12-5_14-47-51.png)
![](assets/duo-jia-gou-jing-xiang-gou-jian-fang-an/image-2023-12-5_14-48-2.png)
![](assets/duo-jia-gou-jing-xiang-gou-jian-fang-an/image-2023-12-5_14-50-14.png)
![](assets/duo-jia-gou-jing-xiang-gou-jian-fang-an/image-2023-12-5_14-51-13.png)
![](assets/duo-jia-gou-jing-xiang-gou-jian-fang-an/image-2023-12-5_14-51-31.png)
![](assets/duo-jia-gou-jing-xiang-gou-jian-fang-an/image-2023-12-5_14-51-58.png)
![](assets/duo-jia-gou-jing-xiang-gou-jian-fang-an/image-2023-12-5_14-53-48.png)
![](assets/duo-jia-gou-jing-xiang-gou-jian-fang-an/image-2023-12-5_14-54-6.png)
![](assets/duo-jia-gou-jing-xiang-gou-jian-fang-an/image-2023-12-5_14-55-19.png)
![](assets/duo-jia-gou-jing-xiang-gou-jian-fang-an/image-2023-12-5_14-55-58.png)
![](assets/duo-jia-gou-jing-xiang-gou-jian-fang-an/image-2023-12-5_14-59-20.png)
![](assets/duo-jia-gou-jing-xiang-gou-jian-fang-an/image-2023-12-5_14-59-33.png)
![](assets/duo-jia-gou-jing-xiang-gou-jian-fang-an/image-2023-12-5_14-59-48.png)
![](assets/duo-jia-gou-jing-xiang-gou-jian-fang-an/image-2023-12-5_15-0-1.png)
![](assets/duo-jia-gou-jing-xiang-gou-jian-fang-an/image-2023-12-5_15-0-28.png)
![](assets/duo-jia-gou-jing-xiang-gou-jian-fang-an/image-2023-12-5_15-1-53.png)
![](assets/duo-jia-gou-jing-xiang-gou-jian-fang-an/image-2023-12-5_15-2-1.png)
![](assets/duo-jia-gou-jing-xiang-gou-jian-fang-an/image-2023-12-5_15-2-9.png)
![](assets/duo-jia-gou-jing-xiang-gou-jian-fang-an/image-2023-12-5_15-2-19.png)
- Environment: 3.12.x
- buildx
- buildkit
- containerd
- skopeo
- Jenkins
- Tekton
- ~/.docker/config.json
- Dockerfile
- deployment.yaml
- Component: harbor
- Page ID: 175277077
- Original Title: 多架构镜像构建方案
