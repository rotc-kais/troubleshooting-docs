---
kind:
  - Troubleshooting
products:
  - Alauda Container Platform
  - Alauda DevOps
  - Alauda AI
  - Alauda Application Services
  - Alauda Service Mesh
  - Alauda Developer Portal
ProductsVersion:
  - 4.1.0,4.2.x
---
<!-- A type of document that involves encountering a fault, diagnosing it, performing root cause analysis, and providing solutions. -->

# 部署RabbitMQ集群添加污点容忍

RabbitMQ Pod无法调度到指定节点 节点资源未被RabbitMQ集群独占

## Cause
- 节点未正确设置污点或标签
- 未配置污点容忍或节点亲和性

## Resolution
- 执行kubectl label node 192.168.220.51 192.168.220.52 192.168.220.53 middleware=enable
- 执行kubectl taint node 192.168.220.51 192.168.220.52 192.168.220.53 middleware=enable:NoSchedule
- 在YAML的spec中添加affinity配置，包含nodeAffinity和podAntiAffinity
- 在YAML的spec中添加tolerations配置：- effect: NoSchedule, key: middleware, operator: Equal, value: enable

## [workaround]

## [Related Information]
- Environment: RabbitMQ 3.6.x
- nodeAffinity
- podAntiAffinity
- tolerations
- middleware
- app.kubernetes.io/name
- kubernetes.io/hostname
- rabbitmq:3.8.16-management
- replicas
- Component: rabbitmq
- Page ID: 115516029
- Original Title: 部署RabbitMQ集群添加污点容忍
