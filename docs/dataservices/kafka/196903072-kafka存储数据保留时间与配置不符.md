---
kind:
  - Troubleshooting
products:
  - Alauda Container Platform
  - Alauda DevOps
  - Alauda AI
  - Alauda Application Services
  - Alauda Service Mesh
  - Alauda Developer Portal
ProductsVersion:
  - 4.1.0,4.2.x
---
<!-- A type of document that involves encountering a fault, diagnosing it, performing root cause analysis, and providing solutions. -->

# kafka存储数据保留时间与配置不符

创建topic消息保留时长为3小时，但能消费到12小时前的数据 retention.ms配置为10800000（3小时）但数据未按预期清理

## Cause
- 消息量不足未触发segment文件滚动
- kafka基于segment文件进行过期清理，需segment内所有消息过期才会删除

## Resolution
- 在topic配置中添加segment.ms: "10800000"
- 修改配置后重新写入数据验证保留策略

## [workaround]

## [Related Information]
- Environment: 3-12
- retention.ms
- segment.ms
- kafka topic配置
- segment文件
- Component: kafka
- Page ID: 196903072
- Original Title: 数据服务-kafka-kafka存储数据保留时间与配置不符
